module test-framework

imports utils

signature
    constructors
        Assert : a * b -> Eq
        Fail : a -> Fail

strategies
    run-test(str | name) = map(switch id
                               case ?Assert(_,_):
                                   to-tuple; (str, id) < (equal < !"Success"
                                                                + (Dupl; (<conc-strings> (name, "Result does not match expected result")), id))
                                                       + (Dupl; (<conc-strings> (name, "Failed but shouldn't"), id))
                               case ?Fail(_): get-arguments; Hd; debug; str < (Dupl; (<conc-strings> (name, "Did not fail, but should"), id))
                                                                                   + !"Success"
                               end)