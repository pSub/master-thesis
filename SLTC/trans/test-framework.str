module test-framework

imports utils

signature
    constructors
        Assert : a * b -> Eq
        Fail : a -> Fail

strategies
    
    run-test(str | name) = map(switch id
                               case ?Assert(_,_): to-tuple; (str, id); debug; equal < !"Success" + <conc-strings> (name, "Failed")
                               case ?Fail(_): get-arguments; Hd; str < <conc-strings> (name, "Did not fail, but should") + !"Success"
                               end)