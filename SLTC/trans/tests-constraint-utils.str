module tests-constraint-utils

imports constraint-utils
imports constraint-language

rules     
    
    search-tests = apply-test(!"search", search(|[]),
                              !"x", ![]);
                   apply-test(!"search", search(|["x"]),
                              !"x",  ![("x", [1])]);
                   apply-test(!"search", search(|["a", "x", "b", ["x", "y", "z"]]),
                              !"x",
                              ![("x", [2]), ("x", [4, 1])])

    instantiate-tests = apply-test(!"instantiate", instantiate(|[], []),
                                   !["x"], !["x"]);
                        apply-test(!"instantiate", instantiate(|["x"], ["t"]),
                                   !["x"], !["t"]);
                        apply-test(!"instantiate", instantiate(|["x", ["a", "b"], "y"], ["s", ["u", "v"], "t"]),
                                   !["a", "y"], ["u", "t"]);
                        apply-test(!"instantiate", instantiate(|["x", "y", "x"], ["s", "u", "t"]),
                                   !["x", "x"], ["s", "t"])

    match-constructors-tests = apply-and-fail(!"match-constructors", match-constructors,
                                              !(1, 2));
                               apply-test(!"match-constructors", match-constructors,
                                          !(<mkterm> ("A", []), <mkterm> ("A", [])),
                                          !"match");
                               apply-test(!"match-constructors", match-constructors,
                                          !(1, Var__("x")), !"match")

    tests-constraint-utils =
        search-tests; instantiate-tests; match-constructors-tests